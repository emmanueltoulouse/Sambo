#!/bin/bash
# Pre-commit hook pour v√©rifier le code avant commit

echo "üîç V√©rification du code avant commit..."

# V√©rifier les fichiers Vala
echo "V√©rification des fichiers Vala..."
find src -name '*.vala' | while read file; do
    if grep -q "    " "$file"; then
        echo "‚ùå ERREUR: Espaces en d√©but de ligne dans $file"
        exit 1
    fi
    if grep -q $'\t' "$file"; then
        echo "‚ùå ERREUR: Tabulations dans $file"
        exit 1
    fi
done

# V√©rifier que le projet compile
echo "V√©rification de la compilation..."
if [ -d "build" ]; then
    if ! meson compile -C build > /dev/null 2>&1; then
        echo "‚ùå ERREUR: Le projet ne compile pas"
        exit 1
    fi
else
    echo "‚ö†Ô∏è  ATTENTION: Dossier build non trouv√©, compilation non v√©rifi√©e"
fi

echo "‚úÖ V√©rifications r√©ussies, commit autoris√©"
exit 0
